var p=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var A=(e,t)=>{for(var o in t)p(e,o,{get:t[o],enumerable:!0})},L=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of w(t))!E.call(e,i)&&i!==o&&p(e,i,{get:()=>t[i],enumerable:!(r=T(t,i))||r.enumerable});return e};var _=e=>L(p({},"__esModule",{value:!0}),e);var N={};A(N,{activate:()=>M});module.exports=_(N);var n=require("coc.nvim");function S(e,t){return e.line!==t.end.line||e.character!==t.end.character}function D(e,t){return new Promise(o=>{e.getVar("_copilot").then(r=>{if(Array.isArray(r==null?void 0:r.suggestions))o(r.suggestions);else if(t){let i=null,u=setTimeout(()=>{clearInterval(i),o([])},5e3);i=setInterval(async()=>{var l;let s=await e.getVar("_copilot");Array.isArray(s==null?void 0:s.suggestions)&&((l=s==null?void 0:s.suggestions)==null?void 0:l.length)&&(clearTimeout(u),clearInterval(i),o(s.suggestions))},500)}else return o(null)})})}var M=async e=>{let t=n.workspace.getConfiguration("copilot"),o=t.get("enable",!0),r=t.get("kindLabel","\uF113\xA0"),i=t.get("priority",1e3),u=t.get("limit",10),s=t.get("enablePreselect",!0),l=t.get("shortcut","Cop"),f=t.get("autoUpdateCompletion",!0);if(!o)return;let y={async provideCompletionItems(U,d,V,P){let{option:c}=P,C=null,b=[],v=await n.workspace.nvim.call("getbufvar",["","&filetype"]);if(c){let x=n.workspace.nvim.createBuffer(c.bufnr),m=await D(x,f);if(!m||m.length===0)return null;let h=c.input;m.forEach(({range:a,text:g})=>{let k={line:a.start.line,character:a.start.character},I=h.length===0&&S(d,a)?d:{line:a.end.line,character:a.end.character};b.push({label:g.replace(/\n/g,"\u21B5"),kind:r,detail:"",documentation:{kind:n.MarkupKind.Markdown,value:`\`\`\`${v}
${g}
\`\`\``},textEdit:n.TextEdit.replace(n.Range.create(k,I),g),preselect:s})}),C={items:b.slice(0,u),isIncomplete:h.length<=3}}return C}};e.subscriptions.push(n.languages.registerCompletionItemProvider("copilot",l,null,y,[],i))};0&&(module.exports={activate});
