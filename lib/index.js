var u=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var E=(e,t)=>{for(var i in t)u(e,i,{get:t[i],enumerable:!0})},A=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of T(t))!w.call(e,o)&&o!==i&&u(e,o,{get:()=>t[o],enumerable:!(r=I(t,o))||r.enumerable});return e};var L=e=>A(u({},"__esModule",{value:!0}),e);var M={};E(M,{activate:()=>D});module.exports=L(M);var n=require("coc.nvim");function _(e,t){return e.line!==t.end.line||e.character!==t.end.character}function S(e){return new Promise(t=>{e.getVar("_copilot").then(i=>{if(Array.isArray(i==null?void 0:i.suggestions))t(i.suggestions);else{let r=null,o=setTimeout(()=>{clearInterval(r),t([])},5e3);r=setInterval(async()=>{let s=await e.getVar("_copilot");Array.isArray(s==null?void 0:s.suggestions)&&(clearTimeout(o),clearInterval(r),t(s.suggestions))},50)}})})}var D=async e=>{let t=n.workspace.getConfiguration("copilot"),i=t.get("enable",!0),r=t.get("kindLabel","\uF113\xA0"),o=t.get("priority",1e3),s=t.get("limit",10),b=t.get("enablePreselect",!0),f=t.get("shortcut","Cop");if(!i)return;let h={async provideCompletionItems(N,m,V,y){let{option:l}=y,g=null,p=[],P=await n.workspace.nvim.call("getbufvar",["","&filetype"]);if(l){let v=n.workspace.nvim.createBuffer(l.bufnr),d=await S(v);if(!d)return null;let C=l.input;d.forEach(({range:a,text:c})=>{let x={line:a.start.line,character:a.start.character},k=C.length===0&&_(m,a)?m:{line:a.end.line,character:a.end.character};p.push({label:c,kind:r,detail:"",documentation:{kind:n.MarkupKind.Markdown,value:`\`\`\`${P}
${c}
\`\`\``},textEdit:n.TextEdit.replace(n.Range.create(x,k),c),preselect:b})}),g={items:p.slice(0,s),isIncomplete:C.length<=3}}return g}};e.subscriptions.push(n.languages.registerCompletionItemProvider("copilot",f,null,h,[],o))};0&&(module.exports={activate});
