var m=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var A=(e,t)=>{for(var o in t)m(e,o,{get:t[o],enumerable:!0})},L=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of w(t))!E.call(e,i)&&i!==o&&m(e,i,{get:()=>t[i],enumerable:!(r=T(t,i))||r.enumerable});return e};var _=e=>L(m({},"__esModule",{value:!0}),e);var N={};A(N,{activate:()=>M});module.exports=_(N);var n=require("coc.nvim");function S(e,t){return e.line!==t.end.line||e.character!==t.end.character}function D(e,t){return new Promise(o=>{e.getVar("_copilot").then(r=>{if(Array.isArray(r==null?void 0:r.suggestions))o(r.suggestions);else if(t){let i=null,l=setTimeout(()=>{clearInterval(i),o([])},5e3);i=setInterval(async()=>{let s=await e.getVar("_copilot");Array.isArray(s==null?void 0:s.suggestions)&&(clearTimeout(l),clearInterval(i),o(s.suggestions))},50)}else return o(null)})})}var M=async e=>{let t=n.workspace.getConfiguration("copilot"),o=t.get("enable",!0),r=t.get("kindLabel","\uF113\xA0"),i=t.get("priority",1e3),l=t.get("limit",10),s=t.get("enablePreselect",!0),f=t.get("shortcut","Cop"),h=t.get("autoUpdateCompletion",!1);if(!o)return;let y={async provideCompletionItems(U,g,V,P){let{option:c}=P,p=null,d=[],v=await n.workspace.nvim.call("getbufvar",["","&filetype"]);if(c){let x=n.workspace.nvim.createBuffer(c.bufnr),C=await D(x,h);if(!C)return null;let b=c.input;C.forEach(({range:a,text:u})=>{let k={line:a.start.line,character:a.start.character},I=b.length===0&&S(g,a)?g:{line:a.end.line,character:a.end.character};d.push({label:u,kind:r,detail:"",documentation:{kind:n.MarkupKind.Markdown,value:`\`\`\`${v}
${u}
\`\`\``},textEdit:n.TextEdit.replace(n.Range.create(k,I),u),preselect:s})}),p={items:d.slice(0,l),isIncomplete:b.length<=3}}return p}};e.subscriptions.push(n.languages.registerCompletionItemProvider("copilot",f,null,y,[],i))};0&&(module.exports={activate});
