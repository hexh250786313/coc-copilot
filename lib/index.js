var d=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var A=(e,t)=>{for(var o in t)d(e,o,{get:t[o],enumerable:!0})},L=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of w(t))!E.call(e,s)&&s!==o&&d(e,s,{get:()=>t[s],enumerable:!(n=T(t,s))||n.enumerable});return e};var _=e=>L(d({},"__esModule",{value:!0}),e);var N={};A(N,{activate:()=>M});module.exports=_(N);var i=require("coc.nvim");function S(e,t){return e.line!==t.end.line||e.character!==t.end.character}function D(e,t){return new Promise(o=>{e.getVar("_copilot").then(n=>{var s;if(Array.isArray(n==null?void 0:n.suggestions)&&((s=n==null?void 0:n.suggestions)==null?void 0:s.length))o(n.suggestions);else if(t){let a=null,c=setTimeout(()=>{clearInterval(a),o([])},5e3);a=setInterval(async()=>{var u;let r=await e.getVar("_copilot");Array.isArray(r==null?void 0:r.suggestions)&&((u=r==null?void 0:r.suggestions)==null?void 0:u.length)&&(clearTimeout(c),clearInterval(a),o(r.suggestions))},500)}else return o(null)})})}var M=async e=>{let t=i.workspace.getConfiguration("copilot"),o=t.get("enable",!0),n=t.get("kindLabel","\uF113\xA0"),s=t.get("priority",1e3),a=t.get("limit",10),c=t.get("enablePreselect",!0),r=t.get("shortcut","Cop"),u=t.get("autoUpdateCompletion",!0);if(!o)return;let y={async provideCompletionItems(U,C,V,P){let{option:m}=P,h=null,b=[],v=await i.workspace.nvim.call("getbufvar",["","&filetype"]);if(m){let x=i.workspace.nvim.createBuffer(m.bufnr),g=await D(x,u);if(!g||g.length===0)return null;let f=m.input;g.forEach(({range:l,text:p})=>{let k={line:l.start.line,character:l.start.character},I=f.length===0&&S(C,l)?C:{line:l.end.line,character:l.end.character};b.push({label:p.replace(/\n/g,"\u21B5"),kind:n,detail:"",documentation:{kind:i.MarkupKind.Markdown,value:`\`\`\`${v}
${p}
\`\`\``},textEdit:i.TextEdit.replace(i.Range.create(k,I),p),preselect:c})}),h={items:b.slice(0,a),isIncomplete:f.length<=3}}return h}};e.subscriptions.push(i.languages.registerCompletionItemProvider("copilot",r,null,y,[],s))};0&&(module.exports={activate});
